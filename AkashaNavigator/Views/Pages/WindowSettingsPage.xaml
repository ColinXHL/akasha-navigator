<UserControl x:Class="AkashaNavigator.Views.Pages.WindowSettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             Background="Transparent"
             Cursor="Arrow">

    <StackPanel>
            <!-- æ ‡é¢˜ -->
            <TextBlock Text="çª—å£è®¾ç½®" FontSize="18" FontWeight="SemiBold"
                       Foreground="White" Margin="0,0,0,16"/>

            <!-- çª—å£è¡Œä¸º -->
            <TextBlock Text="çª—å£è¡Œä¸º" Style="{StaticResource SettingsGroupHeaderStyle}"/>
            <CheckBox x:Name="EdgeSnapCheckBox" Content="å¯ç”¨è¾¹ç¼˜å¸é™„"
                      Style="{StaticResource DarkCheckBoxStyle}" Margin="0,0,0,12"
                      IsChecked="{Binding EnableEdgeSnap, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
            <Grid Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="45"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="å¸é™„é˜ˆå€¼" Style="{StaticResource SettingsLabelStyle}"/>
                <Slider x:Name="SnapThresholdSlider" Grid.Column="1"
                        Style="{StaticResource DarkSliderStyle}"
                        Minimum="5" Maximum="30" TickFrequency="5" IsSnapToTickEnabled="True"
                        Value="{Binding SnapThreshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <TextBlock Grid.Column="2" Text="{Binding SnapThreshold, StringFormat={}{0}px}"
                           Style="{StaticResource SettingsLabelStyle}" HorizontalAlignment="Right"/>
            </Grid>
            <CheckBox x:Name="PromptRecordOnExitCheckBox" Content="é€€å‡ºæ—¶æç¤ºè®°å½•"
                      Style="{StaticResource DarkCheckBoxStyle}" Margin="0,0,0,12"
                      IsChecked="{Binding PromptRecordOnExit, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBlock Text="å…³é—­çª—å£æ—¶æç¤ºè®°å½•å½“å‰æ¸¸æˆè¿›åº¦ç¬”è®°"
                       Foreground="#666" FontSize="11" Margin="0,0,0,24"/>

            <!-- é¼ æ ‡æ£€æµ‹é€æ˜Žåº¦è‡ªåŠ¨è°ƒæ•´ -->
            <TextBlock Text="é¼ æ ‡æ£€æµ‹é€æ˜Žåº¦è‡ªåŠ¨è°ƒæ•´" Style="{StaticResource SettingsGroupHeaderStyle}"/>
            <TextBlock Text="å½“æ¸¸æˆ UI æ‰“å¼€ï¼ˆå¦‚åœ°å›¾ï¼‰æ—¶è‡ªåŠ¨é™ä½Žæ’­æ”¾å™¨é€æ˜Žåº¦ï¼Œä½¿ç”¨ ClipCursor API æ£€æµ‹"
                       Foreground="#666" FontSize="11" Margin="0,0,0,12"/>

            <CheckBox x:Name="CursorDetectionEnabledCheckBox" Content="å¯ç”¨å…¨å±€é¼ æ ‡æ£€æµ‹"
                      Style="{StaticResource DarkCheckBoxStyle}" Margin="0,0,0,12"
                      IsChecked="{Binding CursorDetectionEnabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

            <!-- æœ€ä½Žé€æ˜Žåº¦æ»‘å— -->
            <Grid Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="45"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="æœ€ä½Žé€æ˜Žåº¦" Style="{StaticResource SettingsLabelStyle}"/>
                <Slider x:Name="CursorDetectionMinOpacitySlider" Grid.Column="1"
                        Style="{StaticResource DarkSliderStyle}"
                        Minimum="0.1" Maximum="0.8" TickFrequency="0.1" IsSnapToTickEnabled="True"
                        Value="{Binding CursorDetectionMinOpacity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <TextBlock Grid.Column="2" Text="{Binding CursorDetectionMinOpacity, StringFormat={}{0:F1}}"
                           Style="{StaticResource SettingsLabelStyle}" HorizontalAlignment="Right"/>
            </Grid>

            <!-- æ£€æµ‹é—´éš”æ»‘å— -->
            <Grid Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="55"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="æ£€æµ‹é—´éš”" Style="{StaticResource SettingsLabelStyle}"/>
                <Slider x:Name="CursorDetectionCheckIntervalMsSlider" Grid.Column="1"
                        Style="{StaticResource DarkSliderStyle}"
                        Minimum="50" Maximum="500" TickFrequency="50" IsSnapToTickEnabled="True"
                        Value="{Binding CursorDetectionCheckIntervalMs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <TextBlock Grid.Column="2" Text="{Binding CursorDetectionCheckIntervalMs, StringFormat={}{0}ms}"
                           Style="{StaticResource SettingsLabelStyle}" HorizontalAlignment="Right"/>
            </Grid>

            <CheckBox x:Name="CursorDetectionEnableDebugLogCheckBox" Content="å¯ç”¨è°ƒè¯•æ—¥å¿—"
                      Style="{StaticResource DarkCheckBoxStyle}" Margin="0,0,0,12"
                      IsChecked="{Binding CursorDetectionEnableDebugLog, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

            <!-- è¿›ç¨‹ç™½åå• -->
            <TextBlock Text="è¿›ç¨‹ç™½åå•" Style="{StaticResource SettingsLabelStyle}" FontWeight="SemiBold" Margin="0,0,0,8"/>
            <TextBlock Text="é€‰æ‹©éœ€è¦å¯ç”¨é¼ æ ‡æ£€æµ‹çš„æ¸¸æˆè¿›ç¨‹"
                       Foreground="#666" FontSize="11" Margin="0,0,0,8"/>

            <!-- è¿›ç¨‹é€‰æ‹©ä¸‹æ‹‰æ¡† -->
            <Grid Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <ComboBox Grid.Column="0"
                          Style="{StaticResource DarkComboBoxStyle}"
                          ItemContainerStyle="{StaticResource DarkComboBoxItemStyle}"
                          ItemsSource="{Binding RunningProcesses}"
                          SelectedItem="{Binding SelectedProcess}"
                          DisplayMemberPath="DisplayName"/>
                <Button Grid.Column="1" Content="ðŸ”„" Style="{StaticResource ActionButtonStyle}"
                        Command="{Binding RefreshProcessListCommand}"
                        ToolTip="åˆ·æ–°è¿›ç¨‹åˆ—è¡¨"
                        Margin="4,0,0,0" Padding="8,6" FontSize="12"/>
            </Grid>

            <!-- å·²æ·»åŠ çš„ç™½åå•ï¼ˆTag æ ·å¼ï¼‰ -->
            <ItemsControl ItemsSource="{Binding ProcessWhitelist}" Margin="0,0,0,8">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="sys:String">
                        <Border Background="#333" CornerRadius="4" Padding="8,4" Margin="0,0,6,6">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding}" Foreground="White" FontSize="12" VerticalAlignment="Center"/>
                                <Button Content="âœ•" 
                                        Command="{Binding DataContext.RemoveProcessCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                        CommandParameter="{Binding}"
                                        Background="Transparent" Foreground="#888" BorderThickness="0"
                                        Padding="4,0,0,0" FontSize="10" Cursor="Hand"
                                        VerticalAlignment="Center">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <TextBlock Text="{TemplateBinding Content}" 
                                                                   Foreground="{TemplateBinding Foreground}"
                                                                   FontSize="{TemplateBinding FontSize}"
                                                                   Padding="{TemplateBinding Padding}"
                                                                   VerticalAlignment="Center"/>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="#FF6B6B"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- ç©ºç™½åå•æç¤º -->
            <TextBlock Text="å°šæœªæ·»åŠ ä»»ä½•è¿›ç¨‹ï¼Œè¯·ä»Žä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©"
                       Foreground="#666" FontSize="11" Margin="0,0,0,0"
                       Visibility="{Binding ProcessWhitelist.Count, Converter={StaticResource ZeroToVisibleConverter}}"/>
        </StackPanel>
</UserControl>
